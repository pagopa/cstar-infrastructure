{
    "name": "MergeInvalidatedRecords",
    "description": "Merge all temporary CSV files into the final CSV file.",
    "type": "Copy",
    "dependsOn": [
      {
        "activity": "RetrieveOldMergedRecords",
        "dependencyConditions": [
          "Succeeded"
        ]
      }
    ],
    "policy": {
      "timeout": "0.12:00:00",
      "retry": 0,
      "retryIntervalInSeconds": 30,
      "secureOutput": false,
      "secureInput": false
    },
    "typeProperties": {
      "source": {
        "type": "DelimitedTextSource",
        "storeSettings": {
          "type": "AzureBlobStorageReadSettings",
          "recursive": true,
          "wildcardFolderPath": "invalidated",
          "wildcardFileName": "invalidated_*.csv",
          "enablePartitionDiscovery": false
        },
        "formatSettings": {
          "type": "DelimitedTextReadSettings"
        }
      },
      "sink": {
        "type": "DelimitedTextSink",
        "storeSettings": {
          "type": "AzureBlobStorageWriteSettings",
          "copyBehavior": "MergeFiles"
        },
        "formatSettings": {
          "type": "DelimitedTextWriteSettings",
          "quoteAllText": true,
          "fileExtension": ".csv"
        }
      }
    },
    "inputs": [
      {
        "referenceName": "InvalidatedFlows",
        "type": "DatasetReference",
        "parameters": {
          "file": "invalidated.csv"
        }
      }
    ],
    "outputs": [
      {
        "referenceName": "InvalidatedFlows",
        "type": "DatasetReference",
        "parameters": {
          "file": "merged_invalidated.csv"
        }
      }
    ]
  }
  